<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Physics Shapes</title>
  <style>
    body {
      margin: 0;
      background: #111;
      color: white;
      font-family: sans-serif;
      overflow: hidden; /* prevent page scroll */
      touch-action: manipulation; /* stops double-tap zoom */
    }

    #controls {
      position: fixed;
      bottom: 15px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 9999;
    }

    button {
      padding: 10px 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      background: #444;
      color: white;
    }
    button:hover { background: #666; }

    canvas {
      display: block;
    }

    /* Shake animation for shake mode */
    @keyframes crazyShake {
      0%   { transform: translate(0, 0) rotate(0deg); }
      20%  { transform: translate(-10px, -5px) rotate(-3deg); }
      40%  { transform: translate(10px, 5px) rotate(3deg); }
      60%  { transform: translate(-8px, 5px) rotate(-2deg); }
      80%  { transform: translate(8px, -5px) rotate(2deg); }
      100% { transform: translate(0, 0) rotate(0deg); }
    }
  </style>
</head>
<body>
  <div id="controls">
    <button id="spawnRect">Spawn Brick</button>
    <button id="spawnCircle">Spawn Circle</button>
    <button id="spawnPoly">Spawn Triangle</button>
    <button id="modeBtn">Switch to Shake Mode</button>
  </div>

  <canvas id="world"></canvas>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
  <script>
    const { Engine, Render, Runner, World, Bodies, Body, Mouse, MouseConstraint, Events } = Matter;

    const engine = Engine.create();
    const world = engine.world;

    const canvas = document.getElementById('world');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const render = Render.create({
      canvas: canvas,
      engine: engine,
      options: {
        width: window.innerWidth,
        height: window.innerHeight,
        wireframes: false,
        background: "#111"
      }
    });

    Render.run(render);
    const runner = Runner.create();
    Runner.run(runner, engine);

    // Walls
    const walls = [
      Bodies.rectangle(window.innerWidth/2, window.innerHeight+30, window.innerWidth, 60, { isStatic: true }),
      Bodies.rectangle(window.innerWidth/2, -30, window.innerWidth, 60, { isStatic: true }),
      Bodies.rectangle(-30, window.innerHeight/2, 60, window.innerHeight, { isStatic: true }),
      Bodies.rectangle(window.innerWidth+30, window.innerHeight/2, 60, window.innerHeight, { isStatic: true })
    ];
    World.add(world, walls);

    // Mouse control
    const mouse = Mouse.create(render.canvas);
    const mouseConstraint = MouseConstraint.create(engine, {
      mouse: mouse,
      constraint: { stiffness: 0.2, render: { visible: false } }
    });
    World.add(world, mouseConstraint);
    render.mouse = mouse;

    const shapes = [];

    function spawnRect() {
      let box = Bodies.rectangle(Math.random()*window.innerWidth, 50, 60, 30, {
        render: { fillStyle: randomColor() }
      });
      World.add(world, box);
      shapes.push(box);
    }

    function spawnCircle() {
      let circle = Bodies.circle(Math.random()*window.innerWidth, 50, 25, {
        render: { fillStyle: randomColor() }
      });
      World.add(world, circle);
      shapes.push(circle);
    }

    function spawnPoly() {
      let poly = Bodies.polygon(Math.random()*window.innerWidth, 50, 3, 40, {
        render: { fillStyle: randomColor() }
      });
      World.add(world, poly);
      shapes.push(poly);
    }

    function randomColor() {
      const colors = ["#ff4444","#44ff44","#4444ff","#ffff44","#ff44ff","#44ffff"];
      return colors[Math.floor(Math.random()*colors.length)];
    }

    // Buttons
    document.getElementById("spawnRect").addEventListener("click", spawnRect);
    document.getElementById("spawnCircle").addEventListener("click", spawnCircle);
    document.getElementById("spawnPoly").addEventListener("click", spawnPoly);

    // Mode toggle
    let dragMode = true;
    const modeBtn = document.getElementById("modeBtn");

    modeBtn.addEventListener("click", () => {
      dragMode = !dragMode;
      if (dragMode) {
        modeBtn.textContent = "Switch to Shake Mode";
        mouseConstraint.constraint.stiffness = 0.2;
        canvas.style.animation = "none";
      } else {
        modeBtn.textContent = "Switch to Drag Mode";
        mouseConstraint.constraint.stiffness = 0;
        canvas.style.animation = "crazyShake 0.4s infinite";
      }
    });

    // Shake physics from phone motion
    if (window.DeviceMotionEvent) {
      window.addEventListener("devicemotion", (event) => {
        if (!dragMode) {
          let ax = event.accelerationIncludingGravity.x || 0;
          let ay = event.accelerationIncludingGravity.y || 0;
          const forceScale = 0.0005;
          shapes.forEach(body => {
            Body.applyForce(body, body.position, {
              x: ax * forceScale,
              y: -ay * forceScale
            });
          });
        }
      });
    }
  </script>
</body>
</html>
