<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Physics Shapes</title>
  <style>
    body {
      margin: 0;
      background: #111;
      color: white;
      font-family: sans-serif;
      overflow: hidden; /* prevent page scroll */
      touch-action: manipulation; /* stops double-tap zoom */
    }

    #banner-ads-row {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      flex-direction: row;
      gap: 10px;
      z-index: 10000;
      width: auto;
      height: 54px;
      justify-content: center;
      align-items: flex-start;
      background: transparent;
      pointer-events: none; /* allow clicks to pass through except to ads */
    }
    .banner-ad {
      width: 350px;
      height: 50px;
      text-align: center;
      background: transparent;
      pointer-events: auto; /* enable clicks on the ad */
      padding-top: 2px;
    }

    #controls {
      position: fixed;
      /* Move controls below banner row */
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 9999;
    }

    button {
      padding: 10px 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      background: #444;
      color: white;
    }
    button:hover { background: #666; }

    canvas {
      display: block;
    }

    /* Shake animation for shake mode */
    @keyframes crazyShake {
      0%   { transform: translate(0, 0) rotate(0deg); }
      20%  { transform: translate(-10px, -5px) rotate(-3deg); }
      40%  { transform: translate(10px, 5px) rotate(3deg); }
      60%  { transform: translate(-8px, 5px) rotate(-2deg); }
      80%  { transform: translate(8px, -5px) rotate(2deg); }
      100% { transform: translate(0, 0) rotate(0deg); }
    }

    #challengeBox {
      position: fixed;
      top: 110px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(30,30,30,0.95);
      padding: 14px 24px;
      border-radius: 8px;
      font-size: 18px;
      z-index: 9998;
      box-shadow: 0 2px 12px #0008;
      max-width: 90vw;
      text-align: center;
      transition: background 0.2s;
    }
    #challengeBtn {
      margin-left: 12px;
      background: #396aff;
      color: #fff;
      font-weight: bold;
    }
    #challengeBtn:hover { background: #214bb9; }
  </style>
</head>
<body>
<div id="banner-ads-row">
  <div class="banner-ad" id="banner-ad-1"></div>
  <div class="banner-ad" id="banner-ad-2"></div>
  <div class="banner-ad" id="banner-ad-3"></div>
</div>
<script>
function loadAd(adDivId, adKey) {
  const adDiv = document.getElementById(adDivId);
  adDiv.innerHTML = ""; // Remove previous ad

  // Insert atOptions config as a script
  const configScript = document.createElement('script');
  configScript.type = "text/javascript";
  configScript.text = `
    atOptions = {
      'key' : '${adKey}',
      'format' : 'iframe',
      'height' : 50,
      'width' : 350,
      'params' : {}
    };
  `;
  adDiv.appendChild(configScript);

  // Insert the ad loader script
  const adScript = document.createElement('script');
  adScript.type = "text/javascript";
  adScript.src = "//www.highperformanceformat.com/" + adKey + "/invoke.js";
  adDiv.appendChild(adScript);
}

// You can use different ad keys for each ad for better fill, or the same one for redundancy
const adKeys = [
  "33c6e05f0ae701783ecead35e54f3b14", // your ad key 1
  "33c6e05f0ae701783ecead35e54f3b14", // can use diff key if you have
  "33c6e05f0ae701783ecead35e54f3b14", // can use diff key if you have
];

// Load ads initially
for (let i = 0; i < 3; i++) {
  loadAd("banner-ad-" + (i+1), adKeys[i]);
}
// Reload every 6 seconds
setInterval(() => {
  for (let i = 0; i < 3; i++) {
    loadAd("banner-ad-" + (i+1), adKeys[i]);
  }
}, 8000);
</script>
  <div id="controls">
    <button id="spawnRect">Spawn Brick</button>
    <button id="spawnCircle">Spawn Circle</button>
    <button id="spawnPoly">Spawn Triangle</button>
    <button id="modeBtn">Switch to Shake Mode</button>
    <button id="challengeBtn">New Challenge</button>
  </div>
  <div id="challengeBox"></div>
  <canvas id="world"></canvas>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
  <script>
    const { Engine, Render, Runner, World, Bodies, Body, Mouse, MouseConstraint, Events } = Matter;

    const engine = Engine.create();
    const world = engine.world;

    const canvas = document.getElementById('world');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const render = Render.create({
      canvas: canvas,
      engine: engine,
      options: {
        width: window.innerWidth,
        height: window.innerHeight,
        wireframes: false,
        background: "#111"
      }
    });

    Render.run(render);
    const runner = Runner.create();
    Runner.run(runner, engine);

    // Walls
    const walls = [
      Bodies.rectangle(window.innerWidth/2, window.innerHeight+30, window.innerWidth, 60, { isStatic: true }),
      Bodies.rectangle(window.innerWidth/2, -30, window.innerWidth, 60, { isStatic: true }),
      Bodies.rectangle(-30, window.innerHeight/2, 60, window.innerHeight, { isStatic: true }),
      Bodies.rectangle(window.innerWidth+30, window.innerHeight/2, 60, window.innerHeight, { isStatic: true })
    ];
    World.add(world, walls);

    // Mouse control
    const mouse = Mouse.create(render.canvas);
    const mouseConstraint = MouseConstraint.create(engine, {
      mouse: mouse,
      constraint: { stiffness: 0.2, render: { visible: false } }
    });
    World.add(world, mouseConstraint);
    render.mouse = mouse;

    const shapes = [];

    function spawnRect() {
      let box = Bodies.rectangle(Math.random()*window.innerWidth, 170, 60, 30, {
        render: { fillStyle: randomColor() }
      });
      World.add(world, box);
      shapes.push(box);
    }

    function spawnCircle() {
      let circle = Bodies.circle(Math.random()*window.innerWidth, 170, 25, {
        render: { fillStyle: randomColor() }
      });
      World.add(world, circle);
      shapes.push(circle);
    }

    function spawnPoly() {
      let poly = Bodies.polygon(Math.random()*window.innerWidth, 170, 3, 40, {
        render: { fillStyle: randomColor() }
      });
      World.add(world, poly);
      shapes.push(poly);
    }

    function randomColor() {
      const colors = ["#ff4444","#44ff44","#4444ff","#ffff44","#ff44ff","#44ffff"];
      return colors[Math.floor(Math.random()*colors.length)];
    }

    // Buttons
    document.getElementById("spawnRect").addEventListener("click", spawnRect);
    document.getElementById("spawnCircle").addEventListener("click", spawnCircle);
    document.getElementById("spawnPoly").addEventListener("click", spawnPoly);

    // Mode toggle
    let dragMode = true;
    const modeBtn = document.getElementById("modeBtn");

    modeBtn.addEventListener("click", () => {
      dragMode = !dragMode;
      if (dragMode) {
        modeBtn.textContent = "Switch to Shake Mode";
        mouseConstraint.constraint.stiffness = 0.2;
        canvas.style.animation = "none";
      } else {
        modeBtn.textContent = "Switch to Drag Mode";
        mouseConstraint.constraint.stiffness = 0;
        canvas.style.animation = "crazyShake 0.4s infinite";
      }
    });

    // Shake physics from phone motion
    if (window.DeviceMotionEvent) {
      window.addEventListener("devicemotion", (event) => {
        if (!dragMode) {
          let ax = event.accelerationIncludingGravity.x || 0;
          let ay = event.accelerationIncludingGravity.y || 0;
          const forceScale = 0.0005;
          shapes.forEach(body => {
            Matter.Body.applyForce(body, body.position, {
              x: -ax * forceScale,  // invert X for natural left/right
              y: ay * forceScale    // keep Y same for natural up/down
            });
          });
        }
      });
    }

    // Challenge system
    const challenges = [
      "Build the tallest <b>tower</b> you can! Try to stack as high as possible.",
      "Construct a sturdy <b>castle</b> using at least 7 blocks.",
      "Can you make a <b>house</b> shape? Try to add a roof (triangle) on top!",
      "Design a <b>landscape</b> with hills and a sun.",
      "Make a bridge across the screen with only blocks and circles.",
      "Stack a pyramid of at least 4 levels.",
      "Make a shape that looks like a <b>tree</b> using circles and rectangles.",
      "Balance 3 triangles on a single block.",
      "Build a sculpture that doesn't fall when you shake the device.",
      "Create a <b>face</b> using the shapes."
    ];

    const challengeBox = document.getElementById("challengeBox");
    const challengeBtn = document.getElementById("challengeBtn");

    function pickChallenge() {
      const idx = Math.floor(Math.random() * challenges.length);
      challengeBox.innerHTML = "Challenge: " + challenges[idx];
    }
    // On load, show a challenge
    pickChallenge();
    challengeBtn.addEventListener("click", pickChallenge);

    // Responsive: update canvas and walls on resize
    window.addEventListener('resize', () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      // reposition walls
      Body.setPosition(walls[0], { x: window.innerWidth/2, y: window.innerHeight+30 });
      Body.setPosition(walls[1], { x: window.innerWidth/2, y: -30 });
      Body.setPosition(walls[2], { x: -30, y: window.innerHeight/2 });
      Body.setPosition(walls[3], { x: window.innerWidth+30, y: window.innerHeight/2 });
      Body.setVertices(walls[0], [
        {x:0, y:window.innerHeight}, {x:window.innerWidth, y:window.innerHeight}, {x:window.innerWidth, y:window.innerHeight+60}, {x:0, y:window.innerHeight+60}
      ]);
      Body.setVertices(walls[1], [
        {x:0, y:0}, {x:window.innerWidth, y:0}, {x:window.innerWidth, y:-60}, {x:0, y:-60}
      ]);
      Body.setVertices(walls[2], [
        {x:0, y:0}, {x:0, y:window.innerHeight}, {x:-60, y:window.innerHeight}, {x:-60, y:0}
      ]);
      Body.setVertices(walls[3], [
        {x:window.innerWidth, y:0}, {x:window.innerWidth, y:window.innerHeight}, {x:window.innerWidth+60, y:window.innerHeight}, {x:window.innerWidth+60, y:0}
      ]);
    });
  </script>
</body>
</html>
